language: ruby
rvm:
  - 2.1.2

env:
  matrix:
    - DB=mysql MODE=plos SEARCH=plos
    - DB=mysql MODE=default SEARCH=crossref
    # - DB=postgresql
  global:
    secure: "agQGmJu7sSCjuBYu/Sbo4a3WoXA2C/BVPoIUneSR2+soFPeyrAFoHOa/EflxIt+uUEApXiodG+u2twFBf07yMVVojluzmONricmjh563gu6rKR9vhE5ZTUYIo3IHdi/w1OTd28uA0T0RpFcxLRbVg2lm5juxE+GjI+QmeROr4lY="

services:
  - memcached

before_script:
  - cp config/settings.yml.travis config/settings.yml
  - cp config/database.yml.travis config/database.yml
  - mkdir -p tmp/pids

script:
  - bundle exec rake db:setup RAILS_ENV=test
  - bundle exec rake spec

addons:
  code_climate:
    repo_token: 996e94d9a86097c853b5bd92197c07cca653d962528e10406f1e75d78517438c
